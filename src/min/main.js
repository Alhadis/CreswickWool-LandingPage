(function(){var e=window,t=document,n=t.body,i=Array.prototype.forEach,r="hidden",o="textContent"in n?"textContent":"innerText",a=function(e){var t=document.documentElement.style;if(e.toLowerCase()in t)return true;for(var n="Webkit Moz Ms O Khtml",n=(n.toLowerCase()+n).split(" "),i=0;i<10;++i)if(n[i]+e in t)return true;return false};if(!a("Animation")){e.NO_ANIM=true;t.documentElement.classList.add("no-anim")}NodeList.prototype.forEach=HTMLCollection.prototype.forEach=Array.prototype.forEach;if(e.StaticNodeList)StaticNodeList.prototype.forEach=Array.prototype.forEach;Function.prototype.debounce=function(e,t){var n=this,e=e<0?0:e,i,r,o,a,c=function(){var l=Date.now()-i;if(l>=e){if(!t)n.apply(r,o);if(a)clearTimeout(a);a=r=o=null}else a=setTimeout(c,e-l)};return function(){r=this,o=arguments;if(!e)return n.apply(r,o);i=Date.now();if(!a){if(t)n.apply(r,o);a=setTimeout(c,e)}}};var c=t.getElementsByClassName("fold");e.addEventListener("resize",(new function(){i.call(c,function(e){e.style.maxHeight=e.scrollHeight+"px"});return this.constructor}).debounce(80));var l=t.getElementsByClassName("folding-choice");i.call(l,function(e){var t=e.querySelector(".control"),n=e.querySelector(".disclosure"),r=e.querySelectorAll(".choices input"),a=n[o],c=n.getAttribute("data-text-selected");i.call(r,function(e){e.addEventListener("change",function(e){var i=e.target;n[o]=parseInt(i.value)?c.replace("%s",i.nextSibling[o]):a;t.checked=true})})});var s=function(e,n){var i=this,o="show";i.el=t.querySelector(e);i.visible=i.el.classList.contains(o);i.show=function(){if(i.visible){i.hide();setTimeout(function(){i.show()},100);return}i.visible=true;i.el.removeAttribute(r);setTimeout(function(){i.el.classList.add(o)},100);if(n)setTimeout(function(){i.hide(1)},n)};i.hide=function(e){if(i.fading)return;if(e){i.fading=true;setTimeout(function(){i.fading=false;i.hide()},300);i.el.classList.remove(o)}else{i.el.setAttribute(r,r);i.el.classList.remove(o);i.visible=false}}},u=new s("#cart-add"),d=new s("#cart-error",5e3),f=function(e,t,n){var i=new XMLHttpRequest;i.addEventListener("readystatechange",function(e){if(XMLHttpRequest.DONE===this.readyState){(this.status<400?u:d).show()}});i.open("POST","api.php");i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.send("action=add_to_cart&product_id="+e+"&quantity="+Math.min(1,t)+"&size="+(n||1))}.debounce(1e3,true),p=t.getElementById("products");i.call(p.querySelectorAll("article"),function(t){var n=t.getAttribute("data-product-id"),i=t.querySelector(".quantity-field"),r=t.querySelector(".folding-choice"),o=r.querySelector("input.control"),a=r.querySelectorAll(".choices input"),c="glow",l=function(){for(var e=0,t=a.length;e<t;++e)if(a[e].checked)return a[e].value;return null},s=function(){if(e.NO_ANIM){var t=6,n=setInterval(function(){r.classList.toggle(c);if(!--t){o.checked=false;clearInterval(n)}},300)}else r.classList.add(c)}.debounce(1800,true);r.addEventListener("animationend",function(e){if(c===e.animationName){o.checked=false;r.classList.remove(c)}});t.querySelector(".add.btn").addEventListener("click",function(e){var t=l();t?f(n,i.value,t):s();e.preventDefault();return false})})})();