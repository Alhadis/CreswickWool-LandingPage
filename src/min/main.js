(function(){var e=window,t=document,n=t.body,r=Array.prototype.forEach,i="hidden",o="textContent"in n?"textContent":"innerText",a=function(e){var t=document.documentElement.style;if(e.toLowerCase()in t)return true;for(var n="Webkit Moz Ms O Khtml",n=(n.toLowerCase()+n).split(" "),r=0;r<10;++r)if(n[r]+e in t)return true;return false};if(!a("Animation")){e.NO_ANIM=true;t.documentElement.classList.add("no-anim")}NodeList.prototype.forEach=HTMLCollection.prototype.forEach=Array.prototype.forEach;if(e.StaticNodeList)StaticNodeList.prototype.forEach=Array.prototype.forEach;Function.prototype.debounce=function(e,t){var n=this,e=e<0?0:e,r,i,o,a,c=function(){var l=Date.now()-r;if(l>=e){if(!t)n.apply(i,o);if(a)clearTimeout(a);a=i=o=null}else a=setTimeout(c,e-l)};return function(){i=this,o=arguments;if(!e)return n.apply(i,o);r=Date.now();if(!a){if(t)n.apply(i,o);a=setTimeout(c,e)}}};var c=t.getElementsByClassName("fold");e.addEventListener("resize",(new function(){r.call(c,function(e){e.style.maxHeight=e.scrollHeight+"px"});return this.constructor}).debounce(80));var l=t.getElementsByClassName("folding-choice");r.call(l,function(e){var t=e.querySelector(".control"),n=e.querySelector(".disclosure"),i=e.querySelectorAll(".choices input"),a=n[o],c=n.getAttribute("data-text-selected");r.call(i,function(e){e.addEventListener("change",function(e){var r=e.target;n[o]=parseInt(r.value)?c.replace("%s",r.nextSibling[o]):a;t.checked=true})})});var s={el:t.getElementById("cart-message"),visible:false,show:function(){if(s.visible){s.hide();setTimeout(function(){s.show()},100);return}s.visible=true;s.el.removeAttribute(i);setTimeout(function(){s.el.classList.add("show")},100)},hide:function(){s.el.setAttribute(i,i);s.el.classList.remove("show");s.visible=false}},u=function(e,t,n){var r=new XMLHttpRequest;r.addEventListener("readystatechange",function(e){if(XMLHttpRequest.DONE===this.readyState&&this.status<400)s.show()});r.open("POST","api.php");r.setRequestHeader("Content-Type","application/x-www-form-urlencoded");r.send("action=add_to_cart&product_id="+e+"&quantity="+Math.min(1,t))}.debounce(1e3,true),d=t.getElementById("products");r.call(d.querySelectorAll("article"),function(t){var n=t.getAttribute("data-product-id"),r=t.querySelector(".quantity-field"),i=t.querySelector(".folding-choice"),o=i.querySelector("input.control"),a=i.querySelectorAll(".choices input"),c="glow",l=function(){for(var e=0,t=a.length;e<t;++e)if(a[e].checked)return a[e].value;return null},s=function(){if(e.NO_ANIM){var t=6,n=setInterval(function(){i.classList.toggle(c);if(!--t){o.checked=false;clearInterval(n)}},300)}else i.classList.add(c)}.debounce(1800,true);i.addEventListener("animationend",function(e){if(c===e.animationName){o.checked=false;i.classList.remove(c)}});t.querySelector(".add.btn").addEventListener("click",function(e){var t=l();t?u(n,r.value,t):s();e.preventDefault();return false})})})();